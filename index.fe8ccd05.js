const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.size=4,this.score=0,this.status="idle",this.button=document.querySelector(".button.start"),this.gameScore=document.querySelector(".game-score"),this.messageStart=document.querySelector(".message-start"),this.messageLose=document.querySelector(".message-lose"),this.messageWin=document.querySelector(".message-win"),this.isStopGenerateCells=!1,this.initialState=t.map(t=>[...t])}checkVictory(){this.initialState.flat().find(t=>2048===t)&&this.messageWin&&this.button&&(this.status="win",this.messageWin.classList.remove("hidden"),this.button.classList.remove("start"),this.button.classList.add("restart"),this.button.innerHTML="Restart")}checkLose(){if(this.initialState.every(t=>t.every(t=>0!==t))){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)if(e<this.size-1&&this.initialState[t][e]===this.initialState[t][e+1]||t<this.size-1&&this.initialState[t][e]===this.initialState[t+1][e])return;this.status="lose",this.messageLose&&this.messageLose.classList.remove("hidden")}}moveLeft(){if(!this.isStatusPlaying())return;let t=!1;for(let e=0;e<this.size;e++)for(let i=0;i<this.size;i++)for(let s=i+1;s<this.size;s++){let a=this.initialState[e][i],r=this.initialState[e][s];if(0===a&&0!==r){this.initialState[e][i]=r,this.initialState[e][s]=0,t=!0;continue}if(0!==a&&r===a){let r=2*a;this.initialState[e][i]=r,this.initialState[e][s]=0,this.score+=r,t=!0;break}if((0===a||0!==r)&&0!==a&&r!==a)break}t&&(this.isStopGenerateCells||this.transposeState(),this.checkVictory(),this.checkLose())}moveRight(){if(!this.isStatusPlaying())return;this.changeTextButton();let t=!1;for(let e=0;e<this.size;e++)for(let i=this.size-1;i>=0;i--)for(let s=i-1;s>=0;s--){let a=this.initialState[e][i],r=this.initialState[e][s];if(0===a&&0!==r){this.initialState[e][i]=r,this.initialState[e][s]=0,t=!0;continue}if(0!==a&&r===a){let r=2*a;this.initialState[e][i]=r,this.initialState[e][s]=0,this.score+=r,t=!0;break}if(0!==a&&0===r||0!==a&&r!==a)break}t&&(this.isStopGenerateCells||this.transposeState(),this.checkVictory(),this.checkLose())}moveUp(){if(!this.isStatusPlaying())return;this.changeTextButton();let t=!1;for(let e=0;e<this.size;e++)for(let i=0;i<this.size;i++)for(let s=i+1;s<this.size;s++){let a=this.initialState[i][e],r=this.initialState[s][e];if(0===a&&0!==r){this.initialState[i][e]=r,this.initialState[s][e]=0,t=!0;continue}if(0!==a&&r===a){let r=2*a;this.initialState[i][e]=r,this.initialState[s][e]=0,this.score+=r,t=!0;break}if((0===a||0!==r)&&0!==a&&r!==a)break}t&&(this.isStopGenerateCells||this.transposeState(),this.checkVictory(),this.checkLose())}moveDown(){if(!this.isStatusPlaying())return;this.changeTextButton();let t=!1;for(let e=0;e<this.size;e++)for(let i=this.size-1;i>=0;i--)for(let s=i-1;s>=0;s--){let a=this.initialState[i][e],r=this.initialState[s][e];if(0===a&&0!==r){this.initialState[i][e]=r,this.initialState[s][e]=0,t=!0;continue}if(0!==a&&r===a){let r=2*a;this.initialState[i][e]=r,this.initialState[s][e]=0,this.score+=r,t=!0;break}if((0===a||0!==r)&&0!==a&&r!==a)break}t&&(this.isStopGenerateCells||this.transposeState(),this.checkVictory(),this.checkLose())}changeTextButton(){this.button&&(this.button.classList.remove("start"),this.button.classList.add("restart"),this.button.innerHTML="Restart")}getScore(){return this.score}isStatusPlaying(){return"playing"===this.status}getState(){return this.initialState}getStatus(){return this.status}start(){"playing"!==this.status&&(this.transposeState(),this.transposeState(),this.status="playing",this.messageStart&&this.messageStart.classList.add("hidden"))}restart(){this.initialState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.status="idle",this.score=0,this.button&&(this.button.classList.remove("restart"),this.button.classList.add("start"),this.button.innerHTML="Start",this.messageWin.classList.add("hidden")),this.gameScore&&(this.gameScore.innerHTML="0"),this.messageStart&&this.messageStart.classList.remove("hidden"),this.messageLose&&this.messageLose.classList.add("hidden")}generateNewNumber(){return .9>Math.random()?2:4}transposeState(){let t=[];for(let e=0;e<this.size;e++)for(let i=0;i<this.size;i++)0===this.initialState[e][i]&&t.push({row:e,col:i});if(t.length>0){let e=Math.floor(Math.random()*t.length),{row:i,col:s}=t[e];this.initialState[i][s]=this.generateNewNumber()}}};function e(){t.getState().forEach((t,e)=>{t.forEach((t,i)=>{let s=document.querySelectorAll(".field-row")[e].children[i];0!==t?s.innerText=t:s.innerText="",s.className="",s.classList.add("field-cell",`field-cell--${t}`)})})}window.game=t,e(),document.querySelector(".start").addEventListener("click",()=>{"Restart"===t.button.innerHTML?t.restart():t.start(),e()}),document.addEventListener("keydown",({key:i})=>{"ArrowLeft"===i&&t.moveLeft(),"ArrowRight"===i&&t.moveRight(),"ArrowUp"===i&&t.moveUp(),"ArrowDown"===i&&t.moveDown();let s=document.querySelector(".game-score");s&&(s.innerText=t.getScore()),e()});
//# sourceMappingURL=index.fe8ccd05.js.map
